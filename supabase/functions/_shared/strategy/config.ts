/**
 * STRATEGY_CONFIG
 *
 * Главный конфиг стратегического движка.
 * Все цифры управляют поведением системы:
 * - когда звать в Telegram
 * - когда звать на свидание
 * - как считать вовлечённость
 * - как реагировать на паузы
 */

export const STRATEGY_CONFIG = {

  /**
   * ===== INTEREST (ВОВЛЕЧЁННОСТЬ) =====
   *
   * Система считает базовый интерес девушки (0–100).
   * Он растёт и падает в зависимости от её поведения.
   * Interest — главный показатель. Phase — производная от interest + channel.
   */
  interest: {

    // Стартовое значение интереса при создании диалога
    defaultScore: 5,

    // Максимально возможный interest
    max: 100,

    // Минимально возможный interest
    min: 0,

    /**
     * ВЕСА СИГНАЛОВ
     * Насколько каждое действие девушки влияет на interest
     */
    weights: {

      // Она задала вопрос → сильный сигнал вовлечённости
      question: 3,

      // Использует эмодзи → лёгкий позитивный сигнал
      emoji: 2,

      // Сообщение длиннее longMessageWordLimit → она вкладывается
      longMessage: 4,

      // Делится личной информацией (ключевые слова ниже)
      personalInfo: 5,

      // Очень короткий ответ (1-3 слова) → минус к интересу
      shortMessage: -1,

      // Сухое сообщение (dry)
      dryMessage: -3,

      // Shit test не меняет interest
      shitTest: 0,

      // Штраф за отказ (Telegram не дала / свидание отказала)
      rejectionPenalty: -10,
    },

    /**
     * ПОРОГИ ПРИНЯТИЯ РЕШЕНИЙ
     */
    thresholds: {

      // При каком effective_interest можно предлагать Telegram
      telegram: 30,

      // При каком interest появляется лёгкий намёк на свидание (в промпте)
      dateHint: 70,

      // При каком interest ДОЛЖЕН быть намёк на свидание (в промпте)
      dateStrongHint: 80,

      // При каком effective_interest можно звать на свидание (кнопка)
      date: 95,
    },
  },

  /**
   * ===== АНАЛИЗ СООБЩЕНИЯ =====
   *
   * Как система определяет тип сообщения девушки
   */
  message: {

    // До скольких слов сообщение считается коротким
    shortMessageWordLimit: 3,

    // После скольких слов сообщение считается длинным
    longMessageWordLimit: 10,

    /**
     * Ключевые слова, указывающие на личную информацию.
     * Если сообщение содержит их → +personalInfo к interest.
     *
     * Можно добавлять:
     * "работаю", "учусь", "живу", "люблю", "ненавижу"
     */
    personalKeywords: [
      "работаю", "учусь", "живу", "люблю", "мечтаю",
      "ненавижу", "боюсь", "хочу стать", "моя работа",
      "моя мечта", "в детстве", "планирую", "скучаю"
    ],

    // Регулярка для обнаружения эмодзи
    emojiRegex: /[\u{1F300}-\u{1FAFF}]/u
  },

  /**
   * ===== FRESHNESS (АКТУАЛЬНОСТЬ ИНТЕРЕСА) =====
   *
   * Чем дольше пауза, тем ниже effective_interest.
   * Это не обнуляет базовый interest,
   * а снижает готовность к эскалации.
   */
  freshness: {

    // Градации времени с момента последнего сообщения
    tiers: [

      // Если ответ менее чем через 2 часа → интерес максимально актуален
      { hours: 2, multiplier: 1.0 },

      // 2–8 часов → почти без потери
      { hours: 8, multiplier: 0.9 },

      // 8–24 часа → умеренное снижение
      { hours: 24, multiplier: 0.75 },

      // 24–48 часов → значительное снижение
      { hours: 48, multiplier: 0.5 },
    ],

    // Если прошло больше 48 часов
    defaultMultiplier: 0.3
  },

  /**
   * ===== PHASE ЛОГИКА =====
   *
   * Phase теперь полностью вычисляется из interest + channel.
   * Конфиг нужен только для минимальных порогов по количеству сообщений.
   */
  phase: {

    // Минимум сообщений в приложении перед предложением Telegram
    minMessagesForTelegram: 5,

    // Минимум сообщений в Telegram перед приглашением на свидание
    minMessagesForDate: 8,
  },

  /**
   * ===== DECISION ENGINE =====
   *
   * Когда принимать стратегические решения
   */
  decision: {

    // Если нет ответа дольше этого времени → режим REWARM
    rewarmAfterHours: 8,

    // Минимум сообщений в Telegram перед приглашением на свидание
    minMessagesInTelegramForDate: 20
  }
}